{% extends 'base.html.twig' %}

{% block title %}Temps index{% endblock %}

{% block body %}

    <div class="page-wrapper bg-gra-01 p-t-180 p-b-100 font-poppins">
        <div class="contain-block">
            <div class="wrapper wrapper--w780">
                <div class="button">
                    <a class='btn btn-info' href="{{ path('app_register') }}">Créer un nouvel enregistrement de temps</a>
                </div>
                <div class="card card-3">
                    <div class="card-body">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Groupe</th>
                                    <th>Projet</th>
                                    <th>Temps complet de l'équipe</th>
                                    <th>dernieres date de modification</th>
                                </tr>
                            </thead>
                            {% for timer in timer %}
                            <tr>
                                <td>{{ timer.cumul_s }}</td>
                                {% endfor %}
                            {# <tbody>
                                {% for team in teams %}
                                <tr>
                                    <td>{{ team.name }}</td>
                                    {% endfor %}
                                {% for project in projects %}
                                    <td>{{ project.nameProject }}</td>   
                                </tr>
                                <tr>
                                    <td colspan="5">Aucun Temps</td>
                                </tr>
                            {% endfor %} #}
                            </tbody>
                        </table>  
                    </div>
                </div>
                <form name="chronoForm">
                    <input type="text" name="chronotime" id="chronotime" value="0:00:00:00"/>
                    <input type="button" name="startstop" value="start!" onClick="chronoStart()" />
                    <input type="button" name="reset" value="reset!" onClick="chronoReset()" />
                </form>
            </div>
        </div>
    </div>
    <script>
        var startTime = 0
        var start = 0
        var end = 0
        var diff = 0
        var timerID = 0
        window.onload = chronoStart;

        function chrono(){
            end = new Date()
            diff = end - start
            diff = new Date(diff)
            var msec = diff.getMilliseconds()
            var sec = diff.getSeconds()
            var min = diff.getMinutes()
            var hr = diff.getHours()-1
            if (min < 10){
                min = "0" + min
            }
            if (sec < 10){
                sec = "0" + sec
            }
            if(msec < 10){
                msec = "00" +msec
            }
            else if(msec < 100){
                msec = "0" +msec
            }
            document.getElementById("chronotime").value = hr + ":" + min + ":" + sec + ":" + msec
            timerID = setTimeout("chrono()", 10)
        }

        function chronoStart(){
            document.chronoForm.startstop.value = "stop!"
            document.chronoForm.startstop.onclick = chronoStop
            document.chronoForm.reset.onclick = chronoReset
            start = new Date()
            chrono()
        }
        
        function chronoContinue(){
            document.chronoForm.startstop.value = "stop!"
            document.chronoForm.startstop.onclick = chronoStop
            document.chronoForm.reset.onclick = chronoReset
            start = new Date()-diff
            start = new Date(start)
            chrono()
        }
        function chronoReset(){
            document.getElementById("chronotime").value = "0:00:00:000"
            start = new Date()
        }
        function chronoStopReset(){
            document.getElementById("chronotime").value = "0:00:00:000"
            document.chronoForm.startstop.onclick = chronoStart
        }
        function chronoStop(){
            document.chronoForm.startstop.value = "start!"
            document.chronoForm.startstop.onclick = chronoContinue
            document.chronoForm.reset.onclick = chronoStopReset
            clearTimeout(timerID)
        }
    </script>
{% endblock %}
